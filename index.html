<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>WELCOME TO THE GROTTO — INDEX</title>
  <style>
    :root {
      --bg: #000;
      --fg: #fff;
      --accent: #fff;
      --stroke-opacity: 0.65;
      --stroke-width: 2px; /* thinner stroke to match frame + plus signs */ /* small, simple banner */
      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
    }

    /* Inverted theme */
    body.inverted {
      --bg: #fff;
      --fg: #000;
      --accent: #000;
    }

    html, body {
      height: 100%;
    }

    body {
      margin: 0;
      background: var(--bg);
      color: var(--fg);
      font-family: var(--mono);
      cursor: none; /* we draw our own cursor */
      overflow: hidden;
    }

    /* Top auto-scrolling banner */
    .banner {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: var(--banner-height);
      overflow: hidden;
      background: color-mix(in oklab, var(--bg) 75%, var(--fg) 25%);
      z-index: 999;
    }

    .banner-track {
      position: absolute;
      white-space: nowrap;
      will-change: transform;
      animation: marquee 22s linear infinite;
      font-size: 12px; /* simple & small */
      letter-spacing: 0.08em;
      line-height: var(--banner-height);
      color: var(--fg);
    }
    .banner-chunk { margin-right: 3.5rem; }

    @keyframes marquee {
      from { transform: translateX(0); }
      to   { transform: translateX(-50%); }
    }

    .banner .grotto-word {
      padding: 0 0.25rem;
      display: inline-block;
      transition: filter 120ms linear, background 120ms linear, color 120ms linear;
    }

    /* Hovering just the word “grotto” inverts it */
    .banner .grotto-word:hover { background: color-mix(in oklab, var(--fg) 22%, transparent); color: var(--fg); filter: none; }

    /* Clicking the word toggles theme via JS */

    /* Layout */
    .stage {
      position: absolute;
      inset: var(--banner-height) 0 0 0; /* sit below banner */
      display: grid;
      place-items: center;
    }

    .frame {
      position: relative;
      width: min(92vw, 1200px);
      height: min(70vh, 680px);
      border: 2px solid color-mix(in oklab, var(--fg) 55%, transparent);
      box-sizing: border-box;
    }

    /* Two circles wrapped in a flex row */
    .circles {
      position: absolute;
      inset: 0;
      display: grid;
      grid-template-columns: 1fr 1fr;
      align-items: center;
      justify-items: center;
      gap: min(6vw, 48px);
      padding: min(5vw, 40px);
    }
    .circle-wrap { position: relative; width: 340px; height: 340px; display: grid; place-items: center; }

    svg {
      overflow: visible;
    }

    .ring {
      fill: none;
      stroke: var(--fg);
      opacity: var(--stroke-opacity);
      vector-effect: non-scaling-stroke;
    }

    /* Rotating CCW text around right circle */
    .orbit-text {
      font-family: var(--mono);
      font-size: clamp(10px, 1.2vw, 14px);
      letter-spacing: 0.08em;
      text-transform: uppercase;
      fill: var(--fg);
      transform-origin: 50% 50%;
      animation: spin-ccw 14s linear infinite;
    }

    .orbit-wrap:hover .orbit-text { fill: color-mix(in oklab, var(--fg) 85%, transparent); }

    @keyframes spin-ccw {
      from { transform: rotate(0deg); }
      to   { transform: rotate(-360deg); }
    }

    /* Cross (+) marks near bottom-right of each circle */
    .cross {
      position: absolute;
      width: 130px; /* 5x bigger */
      height: 130px;
      opacity: var(--stroke-opacity);
      pointer-events: auto;
    }

    .cross::before,
    .cross::after {
      content: "";
      position: absolute;
      background: var(--fg);
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
    }

    .cross::before { /* vertical bar */
      width: 2px;
      height: 100%;
    }
    .cross::after {  /* horizontal bar */
      height: 2px;
      width: 100%;
    }

    .cross.red::before,
    .cross.red::after { background: red; }

    /* subtle hover cue for crosses */
    .cross:hover { filter: brightness(1.2); }


    /* positions (tuned for the default SVG size below) */
    .in-circle { bottom: 18%; right: 18%; }

    /* right handled by .in-circle shared rule */

    /* Draggable styles */
    .draggable { cursor: none; }

    /* Custom plus-sign cursor that inverts underlying content */
    .cursor-plus {
      position: fixed;
      left: 0; top: 0;
      width: 24px; height: 24px; /* smaller plus cursor */
      pointer-events: none;
      z-index: 1000;
      mix-blend-mode: difference;
    }
    .cursor-plus::before,
    .cursor-plus::after {
      content: "";
      position: absolute;
      left: 50%; top: 50%;
      transform: translate(-50%, -50%);
      background: var(--accent);
    }
    .cursor-plus::before { width: 1px; height: 100%; }
    .cursor-plus::after  { width: 100%; height: 1px; }

    /* Utility: visually hide outline when focusing via mouse */
    :focus { outline-color: color-mix(in oklab, var(--fg) 60%, transparent); }

    /* Responsiveness tweaks */
    @media (max-width: 800px) {
      .frame { height: min(62vh, 560px); }
    }
  </style>
</head>
<body>
  <!-- Custom invert+ cursor -->
  <div class="cursor-plus" aria-hidden="true"></div>

  <!-- Auto-scrolling banner across top -->
  <div class="banner" aria-label="welcome banner">
    <div id="bannerTrack" class="banner-track">
      <span class="banner-chunk">WELCOME TO THE <span class="grotto-word" id="grottoToggle" title="Click to invert the page">GROTTO</span></span>
      <span class="banner-chunk">WELCOME TO THE <span class="grotto-word">GROTTO</span></span>
      <span class="banner-chunk">WELCOME TO THE <span class="grotto-word">GROTTO</span></span>
      <span class="banner-chunk">WELCOME TO THE <span class="grotto-word">GROTTO</span></span>
      <span class="banner-chunk">WELCOME TO THE <span class="grotto-word">GROTTO</span></span>
      <span class="banner-chunk">WELCOME TO THE <span class="grotto-word">GROTTO</span></span>
      <!-- Duplicate to allow seamless scroll -->
      <span class="banner-chunk">WELCOME TO THE <span class="grotto-word">GROTTO</span></span>
      <span class="banner-chunk">WELCOME TO THE <span class="grotto-word">GROTTO</span></span>
      <span class="banner-chunk">WELCOME TO THE <span class="grotto-word">GROTTO</span></span>
      <span class="banner-chunk">WELCOME TO THE <span class="grotto-word">GROTTO</span></span>
    </div>
  </div>

  <!-- Main stage -->
  <main class="stage">
    <div class="frame" aria-label="two circles frame">
      <div class="circles">
        <div class="circle-wrap">
          <svg width="340" height="340" viewBox="0 0 340 340" aria-hidden="true">
            <circle class="ring" cx="170" cy="170" r="150" stroke-width="var(--stroke-width)"></circle>
          </svg>
          <div id="crossLeft" class="cross in-circle" aria-label="static cross"></div>
        </div>

        <div class="circle-wrap">
          <svg class="orbit-wrap" width="340" height="340" viewBox="0 0 340 340" aria-label="Issue circle">
            <defs>
              <path id="circlePath" d="M170,170 m-130,0 a 130,130 0 1,1 260,0 a 130,130 0 1,1 -260,0" />
            </defs>
            <circle class="ring" cx="170" cy="170" r="150" stroke-width="var(--stroke-width)"></circle>
            <g class="orbit-text">
              <text>
                <textPath href="#circlePath" startOffset="0%">ISSUE 01 – DECEMBER 12TH</textPath>
              </text>
            </g>
          </svg>
          <div id="crossRight" class="cross in-circle draggable" aria-label="draggable cross" title="Drag this + to overlap the other one"></div>
        </div>
      </div>
    </div>
  </main>

  <script>
    // ===== Custom plus-sign cursor that inverts background via mix-blend-mode
    const cursor = document.querySelector('.cursor-plus');
    document.addEventListener('pointermove', (e) => {
      cursor.style.transform = `translate(${e.clientX - 12}px, ${e.clientY - 12}px)`; // center the 18x18 cursor
    });

    // ===== Toggle inverted theme when clicking the word “GROTTO” in the banner (first instance)
    const toggleEl = document.getElementById('grottoToggle');
    toggleEl.addEventListener('click', () => {
      document.body.classList.toggle('inverted');
    });

    // ===== Make the right cross draggable, detect overlap with left cross
    const crossLeft  = document.getElementById('crossLeft');
    const crossRight = document.getElementById('crossRight');

    let isDragging = false;
    let dragOffsetX = 0, dragOffsetY = 0;

    const onDown = (e) => {
      isDragging = true;
      const rect = crossRight.getBoundingClientRect();
      const startX = (e.touches ? e.touches[0].clientX : e.clientX);
      const startY = (e.touches ? e.touches[0].clientY : e.clientY);
      dragOffsetX = startX - rect.left;
      dragOffsetY = startY - rect.top;
    };

    const onMove = (e) => {
      if(!isDragging) return;
      const x = (e.touches ? e.touches[0].clientX : e.clientX) - dragOffsetX;
      const y = (e.touches ? e.touches[0].clientY : e.clientY) - dragOffsetY;
      crossRight.style.left = `${x}px`;
      crossRight.style.top  = `${y}px`;
      checkOverlap();
    };

    const onUp = () => { isDragging = false; };

    crossRight.addEventListener('pointerdown', onDown);
    document.addEventListener('pointermove', onMove);
    document.addEventListener('pointerup', onUp);
    // Touch support
    crossRight.addEventListener('touchstart', onDown, {passive:true});
    document.addEventListener('touchmove', onMove, {passive:false});
    document.addEventListener('touchend', onUp);

    function centerOf(el){
      const r = el.getBoundingClientRect();
      return { x: r.left + r.width/2, y: r.top + r.height/2 };
    }

    function distance(a,b){
      const dx = a.x - b.x, dy = a.y - b.y; return Math.hypot(dx,dy);
    }

    function checkOverlap(){
      const a = centerOf(crossLeft);
      const b = centerOf(crossRight);
      const d = distance(a,b);
      const threshold = 8; // within 8px counts as "perfectly overlapped"
      const overlapped = d <= threshold;
      crossLeft.classList.toggle('red', overlapped);
      crossRight.classList.toggle('red', overlapped);
      crossRight.dataset.overlapped = overlapped ? '1' : '0';
    }

    // If overlapped and clicked, go to a secret page
    crossRight.addEventListener('click', () => {
      if(crossRight.dataset.overlapped === '1') {
        window.location.href = 'secret.html';
      }
    });

    // Initial check
    checkOverlap();

    // ===== Accessibility: pause banner on hover (optional but nice) =====
    const bannerTrack = document.getElementById('bannerTrack');
    bannerTrack.addEventListener('mouseenter', () => { bannerTrack.style.animationPlayState = 'paused'; });
    bannerTrack.addEventListener('mouseleave', () => { bannerTrack.style.animationPlayState = 'running'; });
  </script>
</body>
</html>
